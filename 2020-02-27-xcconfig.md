---
title: Archivos de configuraci√≥n de compilaci√≥n de Xcode
author: Mattt
translator: Nicol√°s Garc√≠a
category: Xcode
excerpt: >-
Las mejores pr√°cticas de desarrollo de software prescriben la estricta separaci√≥n entre configuraci√≥n y c√≥digo. Aprenda c√≥mo puede utilizar los archivos `xcconfig` para hacer sus proyectos m√°s comprensibles, compactos y potentes.
status:
  swift: 5.2
revisions:
  2019-05-13: Initial Publication
  2020-02-27: Updated for Xcode 11.4
---

Las mejores pr√°cticas de desarrollo de software [prescriben](https://12factor.net/config) la estricta separaci√≥n entre configuraci√≥n y c√≥digo. Sin embargo, los desarrolladores de las plataformas de Apple a menudo luchan con hacerlas cuadrar con el pesado flujo de trabajo de Xcode.

En un proyecto, comprender lo que cada configuraci√≥n hace y c√≥mo interact√∫an entre s√≠, es una habilidad que puede llevar a√±os perfeccionar. Tampoco nos hace ning√∫n favor el hecho de que gran parte de esta informaci√≥n est√© enterrada en lo profundo de las GUIs (interfaces gr√°ficas de usuario) de Xcode.

Dir√≠jase a la pesta√±a "Build Settings" (Configuraci√≥n de compilaci√≥n) del editor y ser√° recibido por _cientos_ de configuraciones de compilaci√≥n, distribuidas en capas de proyectos, targets y configuraciones --- _¬°y esto es nada comparado a las otras seis pesta√±as!_

<picture>
    <source srcset="{% asset xcconfig-project-build-settings--dark.png @path %}" media="(prefers-color-scheme: dark)">
    <img src="{% asset xcconfig-project-build-settings--light.png @path %}" alt="Xcode build settings">
</picture>

Afortunadamente, hay una mejor manera de administrar toda esta configuraci√≥n, la cual implica no tener que hacer clicks dentro de un laberinto de pesta√±as.

Esta semana, le mostraremos c√≥mo puede utilizar los archivos de texto de extensi√≥n `xcconfig` para externalizar la configuraci√≥n de compilaci√≥n de Xcode, haciendo que sus proyectos sean m√°s compactos, potentes y comprensibles.

{% info %}

Consulte [XcodeBuildSettings.com](https://xcodebuildsettings.com) para acceder a una completa referencia de cada configuraci√≥n de compilaci√≥n, compatible con la √∫ltima versi√≥n de Xcode.

{% endinfo %}

* * *

[Los archivos de configuraci√≥n de compilaci√≥n Xcode](https://help.apple.com/xcode/mac/8.3/#/dev745c5c974), m√°s com√∫nmente conocidos por su extensi√≥n `xcconfig`, permiten que la configuraci√≥n de compilaci√≥n de su aplicaci√≥n se declare y administre sin utilizar Xcode. Son archivos de texto simples, lo que significa que son mucho m√°s amigables con los sistemas de control de versiones y que se pueden modificar con cualquier editor de texto.

Fundamentalmente, cada archivo de configuraci√≥n consiste de una secuencia de asignaciones en formato clave-valor, con la siguiente sintaxis:

```xcconfig
<#NOMBRE_DE_CONFIGURACION#> = <#valor#>
```

Por ejemplo, para especificar la versi√≥n de Swift de un proyecto, debe especificar la configuraci√≥n de compilaci√≥n `SWIFT_VERSION` de esta manera:

```xcconfig
SWIFT_VERSION = 5.0
```

{% info %}

Seg√∫n el [est√°ndar <abbr title="Portable Operating System Interface">POSIX</abbr>](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08), las variables de entorno deben tener nombres que consisten √∫nicamente de letras may√∫sculas, d√≠gitos y guiones bajos (`_`) - una convenci√≥n que me gusta llamar `SCREAMING_SNAKE_CASE` üêçüóØ.

{% endinfo %}

* * *

A primera vista, los archivos `xcconfig` tienen un sorprendente parecido con los archivos` .env`, debido a su sintaxis simple y delimitada por l√≠neas nuevas. Pero hay m√°s en los archivos de configuraci√≥n de compilaci√≥n de Xcode de lo que pareciera. _¬°A dar una mirada!_

### Reteniendo valores existentes

Para a√±adir, en lugar de reemplazar las definiciones existentes, utilice la variable `$(inherited)` de la siguiente manera:

```xcconfig
<#NOMBRE_DE_CONFIGURACION#> = $(inherited)<#valor adicional#>
```

Normalmente, usted har√≠a esto para crear listas de valores, como por ejemplo, las rutas donde el compilador busca los frameworks para encontrar los archivos de encabezado incluidos (`FRAMEWORK_SEARCH_PATHS`):

```xcconfig
FRAMEWORK_SEARCH_PATHS = $(inherited) $(PROJECT_DIR)
```

Xcode asigna los valores heredados en el siguiente orden (de menor a mayor precedencia):

- Valores predeterminados de la plataforma
- Archivo `xcconfig` del proyecto Xcode
- Configuraci√≥n de compilaci√≥n del archivo de proyecto Xcode
- Archivo `xcconfig` del Target
- Configuraci√≥n de compilaci√≥n del Target

{% info %}

Los espacios se utilizan para delimitar elementos en listas de rutas y texto. Para especificar un elemento que contenga espacios en blanco, debe encerrarlo entre comillas (`"`).

{% endinfo %}

### Referenciando valores

Puede sustituir valores de otras configuraciones mediante el nombre con el cual fueron declaradas usando la siguiente sintaxis:

```xcconfig
<#NOMBRE_DE_CONFIGURACION#> = $(<#OTRO_NOMBRE_DE_CONFIGURACION#>)
```

Las sustituciones se pueden usar para definir nuevas variables de acuerdo con los valores existentes o en l√≠nea para construir nuevos valores din√°micamente.

```xcconfig
OBJROOT = $(SYMROOT)
CONFIGURATION_BUILD_DIR = $(BUILD_DIR)/$(CONFIGURATION)-$(PLATFORM_NAME)
```

### Estableciendo valores por defecto para configuraciones de compilaci√≥n referenciadas

Desde Xcode 11.4 en adelante, puede utilizar el operador de evaluaci√≥n `default` para especificar un valor por defecto a usar en caso de que la configuraci√≥n de compilaci√≥n referenciada se eval√∫e como vac√≠a.

```xcconfig
$(<#NOMBRE_DE_CONFIGURACION#>:default=<#valor#>)
```

### Condicionando las configuraciones de compilaci√≥n

Puede condicionar la configuraci√≥n de compilaci√≥n seg√∫n sus SDK (`sdk`), arquitectura (`arch`) y/o la configuraci√≥n (`config`) utilizando la siguiente sintaxis:

```xcconfig
<#NOMBRE_DE_CONFIGURACION#>[sdk=<#sdk#>] = <#valor para el SDK especificado#>
<#NOMBRE_DE_CONFIGURACION#>[arch=<#architecture#>] = <#valor para la arquitectura especificada#>
<#NOMBRE_DE_CONFIGURACION#>[config=<#configuration#>] = <#valor para la configuraci√≥n especificada#>
```

Dada la posibilidad de elegir entre varias definiciones de una misma configuraci√≥n de compilaci√≥n, el compilador resolver√° seg√∫n la especificidad dada.

```xcconfig
<#NOMBRE_DE_CONFIGURACION#>[sdk=<#sdk#>][arch=<#architecture#>] = <#valor para el SDK y arquitectura especificados#>
<#NOMBRE_DE_CONFIGURACION#>[sdk=*][arch=<#architecture#>] = <#valor para todos los otros SDK con la arquitectura especificada#>
```

Por ejemplo, puede especificar la siguiente configuraci√≥n de compilaci√≥n para acelerar las compilaciones locales compilando solo para la arquitectura activa:

```xcconfig
ONLY_ACTIVE_ARCH[config=Debug][sdk=*][arch=*] = YES
```

### Incluyendo configuraciones de compilaci√≥n desde otros archivos de configuraci√≥n

Un archivo de configuraci√≥n de compilaci√≥n puede incluir configuraciones de otros archivos de configuraci√≥n usando la misma sintaxis `#include` como en la directiva equivalente en `C`, sobre la cual se basa esta funcionalidad:

```xcconfig
#include "<#ruta/de/Archivo.xcconfig#>"
```

Como veremos m√°s adelante en el art√≠culo, puede aprovechar esto para crear listas en cascada de configuraciones de compilaci√≥n de maneras muy poderosas.

{% info %}

Normalmente, cuando el compilador encuentra una directiva `#include` que no se puede resolver, indicar√° un error. Pero los archivos `xcconfig` tambi√©n admiten la directiva `#include?`, la cual no indicar√° un error si el archivo no se puede encontrar.

No hay muchos casos en los que usted quisiera que la existencia o inexistencia de un archivo cambie el comportamiento en tiempo de compilaci√≥n; despu√©s de todo, las compilaciones son mejores cuando son predecibles. Pero, usted podr√≠a usar esta opci√≥n en herramientas de desarrollo opcionales como [Reveal](https://revealapp.com/), la cual requiere la siguiente configuraci√≥n:

```xcconfig
# Reveal.xcconfig
OTHER_LDFLAGS = $(inherited) -weak_framework RevealServer
FRAMEWORK_SEARCH_PATHS = $(inherited) /Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries
```

{% endinfo %}

## Creando archivos de configuraci√≥n de compilaci√≥n

Para crear un archivo de configuraci√≥n de compilaci√≥n, vaya al men√∫ "File > New File..." (<kbd>‚åò</kbd><kbd>N</kbd>), despl√°cese hacia abajo hasta la secci√≥n etiquetada "Other", y seleccione la plantilla del archivo de ajustes de configuraci√≥n (_Configuration Settings File_). Luego, gu√°rdelo en alg√∫n lugar del directorio de su proyecto, asegur√°ndose de no agregarlo a ning√∫n target.

<picture>
    <source srcset="{% asset xcconfig-new-file--dark.png @path %}" media="(prefers-color-scheme: dark)">
    <img src="{% asset xcconfig-new-file--light.png @path %}" alt="Xcode new configuration file">
</picture>

Una vez que haya creado el archivo `xcconfig`, puede asignarlo a una o m√°s configuraciones de compilaci√≥n mediante sus targets asociados.

<picture>
    <source srcset="{% asset xcconfig-project-configurations--dark.png @path %}" media="(prefers-color-scheme: dark)">
    <img src="{% asset xcconfig-project-configurations--light.png @path %}" alt="Xcode project configuration">
</picture>

{% info %}

Los archivos de configuraci√≥n de compilaci√≥n no deben ser incluidos en ninguno de los targets de su proyecto. Si encuentra archivos `.xcconfig` en el archivo` .ipa` de su aplicaci√≥n, aseg√∫rese de que no sean miembros de ning√∫n target y que no aparecen en ninguna fase de compilaci√≥n en "Copy Bundle Resources".

{% endinfo %}

* * *

Ahora que hemos cubierto los conceptos b√°sicos del uso de archivos de configuraci√≥n de compilaci√≥n de Xcode, veamos un par de ejemplos de c√≥mo puede usarlos para gestionar entornos de desarrollo, integraci√≥n y producci√≥n.

* * *

## Customizando el √≠cono y nombre de la app para compilaciones internas

El desarrollo de una aplicaci√≥n para iOS generalmente implica hacer malabarismos con varias compilaciones internas en los simuladores y dispositivos de pruebas (as√≠ como la √∫ltima versi√≥n de la App Store).

Puede facilitarse las cosas con archivos `xcconfig`, asignando en cada configuraci√≥n un √≠cono y nombre distintivos para la aplicaci√≥n.

```xcconfig
// Development.xcconfig
PRODUCT_NAME = $(inherited) Œ±
ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon-Alpha

//////////////////////////////////////////////////

// Staging.xcconfig
PRODUCT_NAME = $(inherited) Œ≤
ASSETCATALOG_COMPILER_APPICON_NAME = AppIcon-Beta
```

## Gestionando constantes a trav√©s de distintos entornos

Si sus desarrolladores back-end act√∫an de acuerdo con la filosof√≠a [12 Factor App](https://12factor.net/config) mencionada anteriormente, tendr√°n entonces endpoints separados para entornos de desarrollo, integraci√≥n y producci√≥n.

En iOS, quiz√°s el enfoque m√°s com√∫n para administrar estos entornos es usar sentencias de compilaci√≥n condicional, con configuraciones de compilaci√≥n tales como `DEBUG`.

```swift
import Foundation

#if DEBUG
let apiBaseURL = URL(string: "https://api.staging.example.com")!
#else
let apiBaseURL = URL(string: "https://api.example.com")!
#endif
```

Esto hace el trabajo, pero entra en conflicto con el canon de la separaci√≥n entre c√≥digo y configuraci√≥n.

Un enfoque alternativo es tomar estos valores espec√≠ficos para el entorno y ponerlos donde pertenecen - en archivos `xcconfig`.

```xcconfig
// Development.xcconfig
API_BASE_URL = api.staging.example.com

//////////////////////////////////////////

// Production.xcconfig
API_BASE_URL = api.example.com
```

{% warning %}

Los archivos `xcconfig` tratan la secuencia `//` como un delimitador de comentarios, independientemente de si est√° o no entre comillas. Si intenta utilizar barras invertidas `\/\/`, estas apareceran literalmente y deber√°n ser eliminadas del valor resultante. Esto es especialmente inconveniente al especificar constantes de tipo URL por cada entorno.

Si prefiere evitar este desafortunado comportamiento, siempre puede omitir el esquema de la URL y anteponer `https://` directamente en el c√≥digo. _(Est√° usando https... ¬øverdad?)_

{% endwarning %}

Sin embargo, para extraer estos valores program√°ticamente, tendremos que dar un paso adicional:

### Accediendo a las configuraciones de compilaci√≥n desde Swift

Las configuraciones de compilaci√≥n definidas por el archivo del proyecto Xcode, los archivos `xcconfig` y las variables de entorno solo est√°n disponibles en tiempo de compilaci√≥n. Cuando ejecute la aplicaci√≥n, ya compilada, nada de ese contexto circundante estar√° disponible. _(¬°Y gracias a Dios por eso!)_

Pero, espere un segundo - ¬øNo recuerda haber visto algunas de esas configuraciones antes? ¬øEn una de esas otras pesta√±as? En "Info", ¬øverdad?

Sucede que esa pesta√±a de informaci√≥n es en realidad solo una presentaci√≥n elegante del archivo `Info.plist` del target. Al momento de compilar, ese archivo `Info.plist` es compilado de acuerdo con la configuraci√≥n de compilaci√≥n proporcionada y luego copiado en el [bundle](/bundles-and-packages/) resultante de la aplicaci√≥n. Por lo tanto, al a√±adir referencias a `$(API_BASE_URL)`, puede acceder a los valores para esas configuraciones a trav√©s de la propiedad `infoDictionary` de la API `Bundle` de Foundation. _¬°Genial!_

<picture>
    <source srcset="{% asset xcconfig-project-info-plist--dark.png @path %}" media="(prefers-color-scheme: dark)">
    <img src="{% asset xcconfig-project-info-plist--light.png @path %}" alt="Xcode Info.plist">
</picture>

Siguiendo este enfoque, podr√≠amos hacer algo como lo siguiente:

```swift
import Foundation

enum Configuration {
    enum Error: Swift.Error {
        case missingKey, invalidValue
    }

    static func value<T>(for key: String) throws -> T where T: LosslessStringConvertible {
        guard let object = Bundle.main.object(forInfoDictionaryKey:key) else {
            throw Error.missingKey
        }

        switch object {
        case let value as T:
            return value
        case let string as String:
            guard let value = T(string) else { fallthrough }
            return value
        default:
            throw Error.invalidValue
        }
    }
}

enum API {
    static var baseURL: URL {
        return try! URL(string: "https://" + Configuration.value(for: "API_BASE_URL"))!
    }
}
```

Visto desde el lugar de llamada, encontramos que este enfoque armoniza maravillosamente con nuestras mejores pr√°cticas - ¬°Ninguna constante definida program√°ticamente a la vista!

```swift
let url = URL(string: path, relativeTo: API.baseURL)!
var request = URLRequest(url: url)
request.httpMethod = method
```

{% error %}

No utilice los archivos `xcconfig` para almacenar secretos como claves de API u otras credenciales. Para m√°s informaci√≥n, consulte nuestro art√≠culo sobre [gesti√≥n de secretos en iOS](https://nshipster.com/secrets/).

{% enderror %}

* * *

Los proyectos de Xcode son monol√≠ticos, fr√°giles y opacos. Son una fuente de fricci√≥n para la colaboraci√≥n entre los miembros de un equipo y, generalmente, complicados de trabajar.

Afortunadamente, los archivos `xcconfig` ayudan mucho para abordar estos puntos d√©biles. Mover la configuraci√≥n de Xcode a los archivos `xcconfig` confiere una multitud de beneficios y ofrece una manera de distanciar su proyecto de las particularidades de Xcode, sin abandonar el "camino feliz" aprobado por Cupertino.
